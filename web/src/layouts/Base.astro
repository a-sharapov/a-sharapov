---
import FooterContent from '@lib/chunks/Footer.astro'
import Canvas from '@lib/components/Canvas/Canvas.svelte'
import Footer from '@lib/components/Footer/Footer.svelte'
import Header from '@lib/components/Header/Header.svelte'
import Locales from '@lib/components/Locales/Locales.svelte'
import Main from '@lib/components/Main/Main.svelte'
import Nav from '@lib/components/Nav/Nav.svelte'
import Vignette from '@lib/components/Vignette/Vignette.svelte'
import { DEFAULT_LOCALE } from '@lib/l18n'
import { determineLocale } from '@lib/shared/utils'
import Head from './Head.astro'

export interface Props {
  scripts?: string
}

const { scripts } = Astro.props
const { slug } = Astro.params
const locale = slug ? determineLocale(slug) : DEFAULT_LOCALE
---

<!doctype html>
<html lang={locale as string}>
  <Head locale={locale as string} scripts={scripts} />
  <body>
    <Header transition:name="header" transition:persist>
      <Nav locale={locale as string} currentUrl={slug} />
      <Locales current={locale as string} />
    </Header>
    <Main client:load>
      <slot />
    </Main>
    <Footer transition:name="footer" transition:persist>
      <FooterContent locale={locale as string} />
    </Footer>
    <slot name="assets" />

    <Canvas {slug} {locale} client:only="svelte" />
    <Vignette transition:name="vignette" transition:persist />
  </body>
</html>
